<?xml version="1.0" encoding="UTF-8" ?>
<solr persistent="true" <% if @zookeeper_hosts %> zkHost="<%= @zookeeper_hosts %>"<% end -%>>
  <cores adminPath="/admin/cores" hostPort="8080" <% if @zookeeper_hosts %> zkClientTimeout="20000" hostContext="solr"<% end -%>>
     <% scope.lookupvar('solr::config::cores').each do |core| -%>
        <% if @numshards -%>
        <% (1..@numshards.to_i).to_a.each do |shard| %>
	<core name="<%= core %>_shard<%= shard %>" instanceDir="<%= core %>_shard<%= shard %>" shard="shard<%= shard %>" collection="<%= core %>" numShards="<%= @numshards %>"/>
	<% end -%>
	<% else -%>
        <core name="<%= core %>" instanceDir="<%= core %>" />
	<% end -%>
     <% end -%>
  </cores>
</solr>
